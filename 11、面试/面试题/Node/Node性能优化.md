性能优化
1. web应用层的优化 对于web应用主要以下几个提升性能的方法:
>1.动静分离
在普通的web应用中，node尽管也能通过中间件实现静态文件服务，但是node处理静态文件的能力并不算突出。将图片、字体、样式表和多媒体等静态文件都引导到专业的静态文件服务器上，让node只处理动态请求即可。这个过程可以用nginx或者专业的cdn来处理。 将动态请求和静态请求分离后，服务器可以专注在动态服务方面，专业的cdn会将静态文件与用户尽可能靠近，同时能够有更精确和高效的缓存机制。静态文件请求分离后，对动态请求使用不同的域名或多个域名还能消除掉不必要的cookie传输和浏览器对下载线程数的限制。

>2.启用缓存
提升性能其实差不多只有两个途径，一个是提升服务的速度，另一个是避免不必要的计算。前者提升的性能在海量流量面前终有瓶颈，但后者却能在访问量越大收益越多。避免不必要的计算，应用场景最多的就是缓存。尽管同步I/O在cpu等待时浪费的时间较为严重，但是在缓存的帮助下，却能消减同步I/O带来的时间浪费。但不管是同步还是异步I/O，避免不必要的计算这条原则入股遵循的好的话，性能提升效果是显著的。

>3.多进程架构
通过多进程架构，不仅可以充分利用多核cpu，更是可以建立机制能让node进程更加健壮，以保障web应用持续服务。

>4.读写分离
除了动静分离之外，另一个较为重要的分离是读写分离，这主要是针对数据库而言，就任数据库而言，读取的速度远远高于写入的数据。而某些数据库在写入时为了保证数据一致性会进行锁表操作，这同时会影响到读取的速度。某些系统为了提升性能，通常会进行数据库的读写分离，将数据库进行主从设计，这样读数据操作不会受到写入的影响，降低了性能的影响。

2. 代码层的优化
>1.使用最新版的nodejs
仅仅使用最新版本的nodejs就能提升性能，nodejs版本的性能提升来自两个方面：v8的版本更新 nodejs内部代码的更新优化

>2.使用fast-json-stringify加速json序列化
在json序列化时，我们需要识别大量的字段类型。比如对于string类型，我们需要在两边都加下",对于数组类型，我们需要遍历数组，把每个对象序列化后，用,隔开，然后在两边加上[ ]

如果已经提前通过Schema知道每个字段的类型，那么就不需要遍历、识别字段类型，而且可以直接用序列化对应的字段，这就大大减少了计算开销，这就是fast-json-stringify的原理